[{"path":"https://phers.hugheylab.org/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jake Hughey. Author, maintainer. Layla Aref. Author.","code":""},{"path":"https://phers.hugheylab.org/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hughey J, Aref L (2022). phers: Calculate Phenotype Risk Scores. https://phers.hugheylab.org, https://github.com/hugheylab/phers.","code":"@Manual{,   title = {phers: Calculate Phenotype Risk Scores},   author = {Jake Hughey and Layla Aref},   year = {2022},   note = {https://phers.hugheylab.org, https://github.com/hugheylab/phers}, }"},{"path":"https://phers.hugheylab.org/index.html","id":"phers","dir":"","previous_headings":"","what":"Calculate Phenotype Risk Scores ","title":"Calculate Phenotype Risk Scores ","text":"phers R package calculating phenotype risk scores quantify person’s likelihood Mendelian disease given data electronic health records. details phenotype risk score model see Bastarache et. al. (2018).","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/index.html","id":"option-1-cran","dir":"","previous_headings":"Installation","what":"Option 1: CRAN","title":"Calculate Phenotype Risk Scores ","text":"","code":"install.packages('phers')"},{"path":"https://phers.hugheylab.org/index.html","id":"option-2-hughey-lab-drat-repository","dir":"","previous_headings":"Installation","what":"Option 2: Hughey Lab Drat Repository","title":"Calculate Phenotype Risk Scores ","text":"Install BiocManager. use RStudio, go Tools → Global Options… → Packages → Add… (Secondary repositories), enter: Name: hugheylab Url: https://hugheylab.github.io/drat/ . can install update package entering: Alternatively, can install update package entering:","code":"if (!requireNamespace('BiocManager', quietly = TRUE))   install.packages('BiocManager') BiocManager::install('phers') BiocManager::install('phers', site_repository = 'https://hugheylab.github.io/drat/')"},{"path":"https://phers.hugheylab.org/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Calculate Phenotype Risk Scores ","text":"Check reference documentation.","code":""},{"path":"https://phers.hugheylab.org/reference/demoSample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample table of demographic information — demoSample","title":"Sample table of demographic information — demoSample","text":"data artificial correspond real patients.","code":""},{"path":"https://phers.hugheylab.org/reference/demoSample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample table of demographic information — demoSample","text":"","code":"demoSample"},{"path":"https://phers.hugheylab.org/reference/demoSample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample table of demographic information — demoSample","text":"data table following columns: person_id: Character vector identifier person cohort sex: Character vector indicating biological sex","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/diseaseDxIcdMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping of diseases and diagnostic ICD codes — diseaseDxIcdMap","title":"Mapping of diseases and diagnostic ICD codes — diseaseDxIcdMap","text":"table provides mapping 27 Mendelian diseases corresponding ICD-9 ICD-10 codes indicate genetic diagnosis.","code":""},{"path":"https://phers.hugheylab.org/reference/diseaseDxIcdMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mapping of diseases and diagnostic ICD codes — diseaseDxIcdMap","text":"","code":"diseaseDxIcdMap"},{"path":"https://phers.hugheylab.org/reference/diseaseDxIcdMap.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mapping of diseases and diagnostic ICD codes — diseaseDxIcdMap","text":"data.table following columns: disease_id: Numeric vector OMIM disease identifiers disease_name: Character vector disease names icd: Character vector ICD codes indicating genetic diagnosis flag: Integer vector vocabulary ICD code (9: ICD-9-CM,  10: ICD-10-CM) icd_name: Character vector containing description ICD code","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/diseaseHpoMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping of Mendelian diseases and their clinical features — diseaseHpoMap","title":"Mapping of Mendelian diseases and their clinical features — diseaseHpoMap","text":"table provides mapping Mendelian diseases clinical features, represented Human Phenotype Ontology (HPO) terms. mapping based annotations Online Mendelian Inheritance Man (OMIM).","code":""},{"path":"https://phers.hugheylab.org/reference/diseaseHpoMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mapping of Mendelian diseases and their clinical features — diseaseHpoMap","text":"","code":"diseaseHpoMap"},{"path":"https://phers.hugheylab.org/reference/diseaseHpoMap.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mapping of Mendelian diseases and their clinical features — diseaseHpoMap","text":"data.table following columns: disease_id: Numeric vector OMIM disease identifiers disease_name: Character vector disease names hpo_term_id: Character vector HPO identifiers corresponding disease's clinical features hpo_term_name: Character vector HPO term descriptions","code":""},{"path":"https://phers.hugheylab.org/reference/diseaseHpoMap.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mapping of Mendelian diseases and their clinical features — diseaseHpoMap","text":"https://hpo.jax.org/app/download/annotation","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getDxStatus.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify cases and controls for Mendelian diseases — getDxStatus","title":"Identify cases and controls for Mendelian diseases — getDxStatus","text":"function useful verifying raw residual phenotype risk scores diagnosed individuals (cases) tend higher scores undiagnosed individuals (controls).","code":""},{"path":"https://phers.hugheylab.org/reference/getDxStatus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify cases and controls for Mendelian diseases — getDxStatus","text":"","code":"getDxStatus(   demos,   icdOccurrences,   minUniqueDates = 2L,   diseaseDxIcdMap = phers::diseaseDxIcdMap )"},{"path":"https://phers.hugheylab.org/reference/getDxStatus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify cases and controls for Mendelian diseases — getDxStatus","text":"demos data.table one row per person cohort. Must column person_id. icdOccurrences data.table occurrences ICD codes person cohort. Must columns person_id, icd, flag, entry_date. minUniqueDates Integer indicating minimum number unique ICD code entry dates required classify person case. Persons least one, fewer minUniqueDates entry dates, assigned neither cases controls. diseaseDxIcdMap data.table mapping diseases corresponding ICD codes indicate diagnosis. Must columns disease_id, icd, flag. Default diseaseDxIcdMap.","code":""},{"path":"https://phers.hugheylab.org/reference/getDxStatus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify cases and controls for Mendelian diseases — getDxStatus","text":"data.table columns person_id, disease_id, dx_status(1 indicates case, 0 indicates control, -1 indicates neither).","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getDxStatus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify cases and controls for Mendelian diseases — getDxStatus","text":"","code":"library('data.table')  dxStatus = getDxStatus(demoSample, icdSample)"},{"path":"https://phers.hugheylab.org/reference/getGeneticAssociations.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform association tests between phenotype risk scores and genotypes — getGeneticAssociations","title":"Perform association tests between phenotype risk scores and genotypes — getGeneticAssociations","text":"association test disease-variant pair based linear model, phenotype risk score dependent variable.","code":""},{"path":"https://phers.hugheylab.org/reference/getGeneticAssociations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform association tests between phenotype risk scores and genotypes — getGeneticAssociations","text":"","code":"getGeneticAssociations(   scores,   genotypes,   demos,   diseaseVariantMap,   lmFormula,   modelType = c(\"genotypic\", \"additive\", \"dominant\", \"recessive\"),   level = 0.95,   dopar = FALSE )"},{"path":"https://phers.hugheylab.org/reference/getGeneticAssociations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform association tests between phenotype risk scores and genotypes — getGeneticAssociations","text":"scores data.table phenotype risk scores. Must columns person_id, disease_id, score. genotypes matrix 'BEDMatrix' object containing genetic data, rownames corresponding person_ids demos scores, colnames corresponding variant_ids diseaseVariantMap. demos data.table characteristics person cohort. Must column person_id. diseaseVariantMap data.table indicating genetic variants test association phenotype risk scores diseases. Must columns disease_id variant_id. lmFormula formula representing linear model (excluding term genotype) use association tests. terms formula must correspond columns demos. modelType string indicating encode genotype model. level number indicating level confidence interval. Default 0.95. dopar Logical indicating whether run calculations parallel parallel backend already set , e.g., using doParallel::registerDoParallel(). Recommended minimize runtime.","code":""},{"path":"https://phers.hugheylab.org/reference/getGeneticAssociations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform association tests between phenotype risk scores and genotypes — getGeneticAssociations","text":"data.table statistics association tests (model fails converge, NAs reported): disease_id: Disease identifier variant_id: Variant identifier n_total: Number persons non-missing genotype data given variant. n_wt: Number persons homozygous wild-type allele. n_het: Number persons one copy alternate allele. n_hom: Number persons homozygous alternate allele. beta: Coefficient association genotype score se: Standard error beta pval: P-value beta non-zero ci_lower: Lower bound confidence interval beta ci_upper: Upper bound confidence interval beta modelType \"genotypic\", data.table include separate statistics heterozygous homozygous genotypes.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getGeneticAssociations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform association tests between phenotype risk scores and genotypes — getGeneticAssociations","text":"","code":"library('data.table') library('BEDMatrix')  # map ICD codes to phecodes phecodeOccurrences = getPhecodeOccurrences(icdSample)  # calculate weights weights = getWeights(demoSample, phecodeOccurrences)  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode()  # calculate scores scores = getScores(   demoSample, phecodeOccurrences, weights, diseasePhecodeMap[disease_id == diseaseId])  # map diseases to genetic variants nvar = 10 diseaseVariantMap = data.table(disease_id = diseaseId, variant_id = paste0('snp', 1:nvar))  # load sample genetic data npop = 50 genoSample = BEDMatrix(system.file('extdata', 'geno_sample.bed', package = 'phers')) #> Extracting number of samples and rownames from geno_sample.fam... #> Extracting number of variants and colnames from geno_sample.bim... colnames(genoSample) = paste0('snp', 1:nvar) rownames(genoSample) = 1:npop  # run genetic association tests genoStats = getGeneticAssociations(   scores, genoSample, demoSample, diseaseVariantMap, lmFormula = ~ sex,   modelType = 'additive')"},{"path":"https://phers.hugheylab.org/reference/getPhecodeOccurrences.html","id":null,"dir":"Reference","previous_headings":"","what":"Map ICD code occurrences to phecode occurrences — getPhecodeOccurrences","title":"Map ICD code occurrences to phecode occurrences — getPhecodeOccurrences","text":"typically first step analysis using phenotype risk scores, next getWeights().","code":""},{"path":"https://phers.hugheylab.org/reference/getPhecodeOccurrences.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map ICD code occurrences to phecode occurrences — getPhecodeOccurrences","text":"","code":"getPhecodeOccurrences(   icdOccurrences,   icdPhecodeMap = phers::icdPhecodeMap,   dxIcd = phers::diseaseDxIcdMap )"},{"path":"https://phers.hugheylab.org/reference/getPhecodeOccurrences.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map ICD code occurrences to phecode occurrences — getPhecodeOccurrences","text":"icdOccurrences data.table occurrences ICD codes person cohort. Must columns person_id, icd, flag. icdPhecodeMap data.table mapping ICD codes phecodes. Must columns icd, phecode, flag. Default map included package. dxIcd data.table ICD codes exclude mapping phecodes. Must columns icd flag. Default table Mendelian diseases corresponding ICD codes indicate genetic diagnosis. NULL, ICD codes excluded.","code":""},{"path":"https://phers.hugheylab.org/reference/getPhecodeOccurrences.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map ICD code occurrences to phecode occurrences — getPhecodeOccurrences","text":"data.table phecode occurrences person.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getPhecodeOccurrences.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map ICD code occurrences to phecode occurrences — getPhecodeOccurrences","text":"","code":"library('data.table')  # map ICD codes to phecodes phecodeOccurrences = getPhecodeOccurrences(icdSample)  # calculate weights weights = getWeights(demoSample, phecodeOccurrences)  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode()  # calculate scores scores = getScores(   demoSample, phecodeOccurrences, weights, diseasePhecodeMap[disease_id == diseaseId])  # calculate residual scores rscores = getResidualScores(demoSample, scores, lmFormula = ~ sex)"},{"path":"https://phers.hugheylab.org/reference/getResidualScores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate residual phenotype risk scores — getResidualScores","title":"Calculate residual phenotype risk scores — getResidualScores","text":"residual score indicates extent person's phenotype risk score given disease deviates expected score, adjusting person's characteristics linear model.","code":""},{"path":"https://phers.hugheylab.org/reference/getResidualScores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate residual phenotype risk scores — getResidualScores","text":"","code":"getResidualScores(demos, scores, lmFormula)"},{"path":"https://phers.hugheylab.org/reference/getResidualScores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate residual phenotype risk scores — getResidualScores","text":"demos data.table characteristics person cohort. Must column person_id. scores data.table containing phenotype risk score person disease. Must columns person_id, disease_id, score. lmFormula formula representing linear model use calculating residual scores. terms formula must correspond columns demos.","code":""},{"path":"https://phers.hugheylab.org/reference/getResidualScores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate residual phenotype risk scores — getResidualScores","text":"data.table, based scores, additional column resid_score. Residual scores disease standardized unit variance.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getResidualScores.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate residual phenotype risk scores — getResidualScores","text":"","code":"library('data.table')  # map ICD codes to phecodes phecodeOccurrences = getPhecodeOccurrences(icdSample)  # calculate weights weights = getWeights(demoSample, phecodeOccurrences)  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode()  # calculate scores scores = getScores(   demoSample, phecodeOccurrences, weights, diseasePhecodeMap[disease_id == diseaseId])  # calculate residual scores rscores = getResidualScores(demoSample, scores, lmFormula = ~ sex)"},{"path":"https://phers.hugheylab.org/reference/getScores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate phenotype risk scores — getScores","title":"Calculate phenotype risk scores — getScores","text":"person's phenotype risk score given disease corresponds sum weights disease-relevant phecodes person received.","code":""},{"path":"https://phers.hugheylab.org/reference/getScores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate phenotype risk scores — getScores","text":"","code":"getScores(demos, phecodeOccurrences, weights, diseasePhecodeMap)"},{"path":"https://phers.hugheylab.org/reference/getScores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate phenotype risk scores — getScores","text":"demos data.table one row per person cohort. Must column person_id. phecodeOccurrences data.table phecode occurrences person cohort. Must columns person_id phecode. weights data.table phecodes corresponding weights. Must columns phecode w. diseasePhecodeMap data.table mapping diseases phecodes. Must columns disease_id phecode.","code":""},{"path":"https://phers.hugheylab.org/reference/getScores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate phenotype risk scores — getScores","text":"data.table containing phenotype risk score person disease.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getScores.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate phenotype risk scores — getScores","text":"","code":"library('data.table')  # map ICD codes to phecodes phecodeOccurrences = getPhecodeOccurrences(icdSample)  # calculate weights weights = getWeights(demoSample, phecodeOccurrences)  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode()  # calculate scores scores = getScores(   demoSample, phecodeOccurrences, weights, diseasePhecodeMap[disease_id == diseaseId])  # calculate residual scores rscores = getResidualScores(demoSample, scores, lmFormula = ~ sex)"},{"path":"https://phers.hugheylab.org/reference/getWeights.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate phecode-specific weights for phenotype risk scores — getWeights","title":"Calculate phecode-specific weights for phenotype risk scores — getWeights","text":"typically second step analysis using phenotype risk scores, next getScores().","code":""},{"path":"https://phers.hugheylab.org/reference/getWeights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate phecode-specific weights for phenotype risk scores — getWeights","text":"","code":"getWeights(demos, phecodeOccurrences)"},{"path":"https://phers.hugheylab.org/reference/getWeights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate phecode-specific weights for phenotype risk scores — getWeights","text":"demos data.table one row per person cohort. Must column person_id. phecodeOccurrences data.table phecode occurrences person cohort. Must columns person_id phecode.","code":""},{"path":"https://phers.hugheylab.org/reference/getWeights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate phecode-specific weights for phenotype risk scores — getWeights","text":"data.table columns phecode, prev (prevalence), w(weight). Prevalence corresponds fraction cohort least one occurrence given phecode. Weight calculated -log10prevalence.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/getWeights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate phecode-specific weights for phenotype risk scores — getWeights","text":"","code":"library('data.table')  # map ICD codes to phecodes phecodeOccurrences = getPhecodeOccurrences(icdSample)  # calculate weights weights = getWeights(demoSample, phecodeOccurrences)  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode()  # calculate scores scores = getScores(   demoSample, phecodeOccurrences, weights, diseasePhecodeMap[disease_id == diseaseId])  # calculate residual scores rscores = getResidualScores(demoSample, scores, lmFormula = ~ sex)"},{"path":"https://phers.hugheylab.org/reference/hpoPhecodeMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping of HPO terms and phecodes — hpoPhecodeMap","title":"Mapping of HPO terms and phecodes — hpoPhecodeMap","text":"table provides mapping Human Phenotype Ontology (HPO) terms phecodes, useful using phecodes represent clinical features Mendelian diseases.","code":""},{"path":"https://phers.hugheylab.org/reference/hpoPhecodeMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mapping of HPO terms and phecodes — hpoPhecodeMap","text":"","code":"hpoPhecodeMap"},{"path":"https://phers.hugheylab.org/reference/hpoPhecodeMap.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mapping of HPO terms and phecodes — hpoPhecodeMap","text":"data.table following columns: hpo_term_id: Character vector HPO term identifiers hpo_term_name: Character vector HPO term descriptions phecode: Character vector phecodes phecode_name: Character vector phecode descriptions","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/icdPhecodeMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping of ICD codes and phecodes — icdPhecodeMap","title":"Mapping of ICD codes and phecodes — icdPhecodeMap","text":"table provides mapping International Classification Diseases 9th 10th revisions (ICD-9-CM ICD-10-CM) phecodes (version 1.2).","code":""},{"path":"https://phers.hugheylab.org/reference/icdPhecodeMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mapping of ICD codes and phecodes — icdPhecodeMap","text":"","code":"icdPhecodeMap"},{"path":"https://phers.hugheylab.org/reference/icdPhecodeMap.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mapping of ICD codes and phecodes — icdPhecodeMap","text":"data.table following columns: icd: Character vector ICD codes flag: Integer vector vocabulary ICD code (9: ICD-9-CM,  10: ICD-10-CM) icd_name: Character vector ICD code descriptions phecode: Character vector phecodes phecode_name: Character vector phecode descriptions","code":""},{"path":"https://phers.hugheylab.org/reference/icdPhecodeMap.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mapping of ICD codes and phecodes — icdPhecodeMap","text":"https://phewascatalog.org/phecodes","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/icdSample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample table of ICD occurrences — icdSample","title":"Sample table of ICD occurrences — icdSample","text":"data artificial correspond real patients.","code":""},{"path":"https://phers.hugheylab.org/reference/icdSample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample table of ICD occurrences — icdSample","text":"","code":"icdSample"},{"path":"https://phers.hugheylab.org/reference/icdSample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample table of ICD occurrences — icdSample","text":"data.table following columns: person_id: Character vector identifier person icd: Character vector ICD codes recorded person flag: Integer vector vocabulary ICD code (9: ICD-9-CM, 10: ICD-10-CM) entry_date: Vector type Date indicating date ICD code recorded.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/mapDiseaseToPhecode.html","id":null,"dir":"Reference","previous_headings":"","what":"Map diseases to phecodes via HPO terms — mapDiseaseToPhecode","title":"Map diseases to phecodes via HPO terms — mapDiseaseToPhecode","text":"mapping diseases clinical features, represented phecodes, required calculating phenotype risk scores.","code":""},{"path":"https://phers.hugheylab.org/reference/mapDiseaseToPhecode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map diseases to phecodes via HPO terms — mapDiseaseToPhecode","text":"","code":"mapDiseaseToPhecode(   diseaseHpoMap = phers::diseaseHpoMap,   hpoPhecodeMap = phers::hpoPhecodeMap )"},{"path":"https://phers.hugheylab.org/reference/mapDiseaseToPhecode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map diseases to phecodes via HPO terms — mapDiseaseToPhecode","text":"diseaseHpoMap data.table containing mapping diseases HPO terms. Must columns disease_id term_id. Default map included package. hpoPhecodeMap data.table containing mapping HPO terms phecodes. Must columns term_id phecode. Default map included package.","code":""},{"path":"https://phers.hugheylab.org/reference/mapDiseaseToPhecode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map diseases to phecodes via HPO terms — mapDiseaseToPhecode","text":"data.table columns disease_id phecode.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/mapDiseaseToPhecode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map diseases to phecodes via HPO terms — mapDiseaseToPhecode","text":"","code":"library('data.table')  # map ICD codes to phecodes phecodeOccurrences = getPhecodeOccurrences(icdSample)  # calculate weights weights = getWeights(demoSample, phecodeOccurrences)  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode()  # calculate scores scores = getScores(   demoSample, phecodeOccurrences, weights, diseasePhecodeMap[disease_id == diseaseId])  # calculate residual scores rscores = getResidualScores(demoSample, scores, lmFormula = ~ sex)"},{"path":"https://phers.hugheylab.org/reference/phers.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform multiple steps of an analysis using phenotype risk scores — phers","title":"Perform multiple steps of an analysis using phenotype risk scores — phers","text":"function can map ICD occurrences phecode occurrences, calculate weights phecode, calculate raw residual phenotype risk scores.","code":""},{"path":"https://phers.hugheylab.org/reference/phers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform multiple steps of an analysis using phenotype risk scores — phers","text":"","code":"phers(   demos,   icdOccurrences,   diseasePhecodeMap,   icdPhecodeMap = phers::icdPhecodeMap,   dxIcd = phers::diseaseDxIcdMap,   weights = NULL,   residScoreFormula = NULL )"},{"path":"https://phers.hugheylab.org/reference/phers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform multiple steps of an analysis using phenotype risk scores — phers","text":"demos data.table one row per person cohort. Must column person_id. icdOccurrences data.table occurrences ICD codes person cohort. Must columns person_id, icd, flag. diseasePhecodeMap data.table mapping diseases phecodes. Must columns disease_id phecode. icdPhecodeMap data.table mapping ICD codes phecodes. Must columns icd, phecode, flag. Default map included package. dxIcd data.table ICD codes exclude mapping phecodes. Must columns icd flag. Default table Mendelian diseases corresponding ICD codes indicate genetic diagnosis. NULL, ICD codes excluded. weights data.table phecodes corresponding weights. Must columns phecode w. NULL (default), weights calculated based data cohort provided. cohort small phecode prevalences reflect population interest, recommended use preCalcWeights. residScoreFormula formula representing linear model use calculating residual scores. terms formula must correspond columns demos. NULL, residual scores calculated.","code":""},{"path":"https://phers.hugheylab.org/reference/phers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform multiple steps of an analysis using phenotype risk scores — phers","text":"list elements: phecodeOccurences: data.table phecode occurrences person cohort. weights: data.table phecodes corresponding weights. scores: data.table raw possibly residual phenotype risk scores person disease.","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/reference/phers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform multiple steps of an analysis using phenotype risk scores — phers","text":"","code":"library('data.table')  # OMIM disease IDs for which to calculate phenotype risk scores diseaseId = 154700  # map diseases to phecodes diseasePhecodeMap = mapDiseaseToPhecode() diseasePhecodeMap = diseasePhecodeMap[disease_id == diseaseId]  # calculate raw and residal scores using weights based on the sample cohort scores = phers(   demoSample, icdSample, diseasePhecodeMap, residScoreFormula = ~ sex)  # calculate scores using pre-calculated weights scores = phers(   demoSample, icdSample, diseasePhecodeMap,   weights = phers::preCalcWeights, residScoreFormula = ~ sex)"},{"path":"https://phers.hugheylab.org/reference/preCalcWeights.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-calculated weights for calculating phenotype risk scores — preCalcWeights","title":"Pre-calculated weights for calculating phenotype risk scores — preCalcWeights","text":"weights based EHR data Vanderbilt University Medical Center Synthetic Derivative (SD) ICD-phecode map version 1.2.","code":""},{"path":"https://phers.hugheylab.org/reference/preCalcWeights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pre-calculated weights for calculating phenotype risk scores — preCalcWeights","text":"","code":"preCalcWeights"},{"path":"https://phers.hugheylab.org/reference/preCalcWeights.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-calculated weights for calculating phenotype risk scores — preCalcWeights","text":"data.table following columns: phecode: Character vector phecodes prev: Numeric vector prevalences, .e., fraction subjects SD least one occurrence given phecode w: Numeric vector weights, calculated -log10(prev)","code":""},{"path":[]},{"path":"https://phers.hugheylab.org/news/index.html","id":"phers-003","dir":"Changelog","previous_headings":"","what":"phers 0.0.3","title":"phers 0.0.3","text":"Set better key residual scores table. Switched lm() instead glm() speed. Simplified genetic association table genotypic model. Switched vid variant_id clarity consistency.","code":""},{"path":"https://phers.hugheylab.org/news/index.html","id":"phers-002","dir":"Changelog","previous_headings":"","what":"phers 0.0.2","title":"phers 0.0.2","text":"CRAN release: 2022-05-10 Set keys data.tables.","code":""},{"path":"https://phers.hugheylab.org/news/index.html","id":"phers-001","dir":"Changelog","previous_headings":"","what":"phers 0.0.1","title":"phers 0.0.1","text":"Updated code documentation.","code":""}]
