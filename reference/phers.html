<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform multiple steps of an analysis using phenotype risk scores — phers • phers</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform multiple steps of an analysis using phenotype risk scores — phers"><meta property="og:description" content="This function can map ICD occurrences to phecode occurrences, calculate
weights for each phecode, and calculate raw and residual phenotype risk
scores."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phers</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/hugheylab/phers/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform multiple steps of an analysis using phenotype risk scores</h1>
    <small class="dont-index">Source: <a href="https://github.com/hugheylab/phers/blob/HEAD/R/phers.R" class="external-link"><code>R/phers.R</code></a></small>
    <div class="hidden name"><code>phers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function can map ICD occurrences to phecode occurrences, calculate
weights for each phecode, and calculate raw and residual phenotype risk
scores.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">phers</span><span class="op">(</span>
  <span class="va">demos</span>,
  <span class="va">icdOccurrences</span>,
  <span class="va">diseasePhecodeMap</span>,
  icdPhecodeMap <span class="op">=</span> <span class="fu">phers</span><span class="fu">::</span><span class="va"><a href="icdPhecodeMap.html">icdPhecodeMap</a></span>,
  dxIcd <span class="op">=</span> <span class="fu">phers</span><span class="fu">::</span><span class="va"><a href="diseaseDxIcdMap.html">diseaseDxIcdMap</a></span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  residScoreFormula <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>demos</dt>
<dd><p>A data.table having one row per person in the cohort. Must have
a column <code>person_id</code>.</p></dd>
<dt>icdOccurrences</dt>
<dd><p>A data.table of occurrences of ICD codes for each
person in the cohort. Must have columns <code>person_id</code>, <code>icd</code>, and <code>flag</code>.</p></dd>
<dt>diseasePhecodeMap</dt>
<dd><p>A data.table of the mapping between diseases and
phecodes. Must have columns <code>disease_id</code> and <code>phecode</code>.</p></dd>
<dt>icdPhecodeMap</dt>
<dd><p>A data.table of the mapping between ICD codes and
phecodes. Must have columns <code>icd</code>, <code>phecode</code>, and <code>flag</code>. Default is the
map included in this package.</p></dd>
<dt>dxIcd</dt>
<dd><p>A data.table of ICD codes to exclude from mapping to phecodes.
Must have columns <code>icd</code> and <code>flag</code>. Default is the table of Mendelian
diseases and the corresponding ICD codes that indicate a genetic diagnosis.
If <code>NULL</code>, no ICD codes will be excluded.</p></dd>
<dt>weights</dt>
<dd><p>A data.table of phecodes and their corresponding weights.
Must have columns <code>phecode</code> and <code>w</code>. If <code>NULL</code> (the default), weights will
be calculated based on data for the cohort provided. If the cohort is small
or its phecode prevalences do not reflect those in the population of
interest, it is recommended to use <a href="preCalcWeights.html">preCalcWeights</a>.</p></dd>
<dt>residScoreFormula</dt>
<dd><p>A formula representing the linear model to use for
calculating residual scores. All terms in the formula must correspond to
columns in <code>demos</code>. If <code>NULL</code>, no residual scores will be calculated.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with elements:</p><ul><li><p><code>phecodeOccurences</code>: A data.table of phecode occurrences for each person
in the cohort.</p></li>
<li><p><code>weights</code>: A data.table of phecodes and their corresponding weights.</p></li>
<li><p><code>scores</code>: A data.table of raw and possibly residual phenotype risk scores
for each person and each disease.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getPhecodeOccurrences.html">getPhecodeOccurrences()</a></code>, <code><a href="getWeights.html">getWeights()</a></code>, <code><a href="getScores.html">getScores()</a></code>,
<code><a href="getResidualScores.html">getResidualScores()</a></code>, <code><a href="mapDiseaseToPhecode.html">mapDiseaseToPhecode()</a></code>, <a href="icdPhecodeMap.html">icdPhecodeMap</a>,
<a href="diseaseDxIcdMap.html">diseaseDxIcdMap</a>, <a href="preCalcWeights.html">preCalcWeights</a>, <code><a href="getDxStatus.html">getDxStatus()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">'data.table'</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># OMIM disease IDs for which to calculate phenotype risk scores</span></span>
<span class="r-in"><span class="va">diseaseId</span> <span class="op">=</span> <span class="fl">154700</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># map diseases to phecodes</span></span>
<span class="r-in"><span class="va">diseasePhecodeMap</span> <span class="op">=</span> <span class="fu"><a href="mapDiseaseToPhecode.html">mapDiseaseToPhecode</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">diseasePhecodeMap</span> <span class="op">=</span> <span class="va">diseasePhecodeMap</span><span class="op">[</span><span class="va">disease_id</span> <span class="op">==</span> <span class="va">diseaseId</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># calculate raw and residal scores using weights based on the sample cohort</span></span>
<span class="r-in"><span class="va">scores</span> <span class="op">=</span> <span class="fu">phers</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">demoSample</span>, <span class="va">icdSample</span>, <span class="va">diseasePhecodeMap</span>, residScoreFormula <span class="op">=</span> <span class="op">~</span> <span class="va">sex</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># calculate scores using pre-calculated weights</span></span>
<span class="r-in"><span class="va">scores</span> <span class="op">=</span> <span class="fu">phers</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">demoSample</span>, <span class="va">icdSample</span>, <span class="va">diseasePhecodeMap</span>,</span>
<span class="r-in">  weights <span class="op">=</span> <span class="fu">phers</span><span class="fu">::</span><span class="va"><a href="preCalcWeights.html">preCalcWeights</a></span>, residScoreFormula <span class="op">=</span> <span class="op">~</span> <span class="va">sex</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jake Hughey, Layla Aref.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

